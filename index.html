<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>VAS評価フォーム</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 40px;
    }
    .container {
      max-width: 400px;
      margin: auto;
    }
    input[type="range"] {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>VAS評価フォーム</h2>

    <label for="subjectId">被験者ID：</label><br>
    <input type="text" id="subjectId" name="subjectId" readonly><br><br>

    <label for="vas">痛みの程度：</label><br>
    <input type="range" id="vas" min="0" max="100" value="50">
    <!-- <p>現在のVAS値：<span id="vasValue">50</span></p> -->

    <button onclick="submitForm()">送信</button>
  </div>

  <script>
    window.onload = function () {
      const urlParams = new URLSearchParams(window.location.search);
      const userId = urlParams.get('id');
      if (userId) {
        document.getElementById("subjectId").value = userId;
      }
    }

    function submitForm() {
      const subjectId = document.getElementById('subjectId').value;
      const vasValue = document.getElementById('vas').value;

      fetch('https://script.google.com/macros/s/AKfycbze2CtIJLxy5ue1pAIPzKyIs0DItowDgcXOVixEacgsdRY08XFxtI1x_pWSqBjoavgj/exec', {
        method: 'POST',
        body: new URLSearchParams({
          'subjectId': subjectId,
          'vasValue': vasValue
        })
      })
      .then(response => response.text())
      .then(result => {
        alert('送信完了しました。ご協力ありがとうございます。');
        document.getElementById('vas').value = 50;
      })
      .catch(error => {
        alert('送信失敗：' + error);
      });
    }
  </script>
</body>
</html>

